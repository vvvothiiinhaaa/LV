<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pettie</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/style-product.css">
    <style>
        :root {
    --primary-color: #FFE4E1;
    --secondary-color: #422522;
    --light-pink-color: #faf4f5;
    --dark-color: #252525;

    /* Font sizes */
    --font-size-sm: 0.9rem;
    --font-size-md: 1rem;
    --font-size-lg: 1.5rem;

    /* Border radius */
    --border-radius: 8px;
}

/* General styles */
body {
    font-family: Arial, sans-serif;
    background-color: var(--light-pink-color);
    margin: 0;
    padding: 0;
}

/* Header */
header {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* Main Product Section */
.product-detailt-section {
    padding-top: 100px;
    padding-bottom: 50px;
}

.product-gallery {
    text-align: center;
}

.product-gallery .main-img-wrapper {
    border: 2px solid #ddd;
    padding: 10px;
    margin-bottom: 15px;
    border-radius: var(--border-radius);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.product-gallery .small-img {
    width: 80px;
    height: 80px;
    cursor: pointer;
    border: 2px solid #ddd;
    border-radius: var(--border-radius);
    transition: transform 0.2s ease, border-color 0.2s ease;
}

.product-gallery .small-img:hover {
    transform: scale(1.1);
    border-color: var(--secondary-color);
}

/* Product Details */
.product-title {
    font-size: var(--font-size-lg);
    font-weight: bold;
    color: var(--dark-color);
}

.product-description {
    color: var(--dark-color);
    line-height: 1.6;
}

.product-price {
    font-size: 1.25rem;
    font-weight: bold;
    color: red;
}

/* Product Weight */
.product-weight {
    display: flex;
    align-items: center;
    gap: 10px;
}

.weight-buttons .btn {
    padding: 10px 20px;
    border-radius: var(--border-radius);
    background-color: var(--light-pink-color);
    color: var(--secondary-color);
    border: 1px solid var(--secondary-color);
    transition: all 0.3s ease;
}

.weight-buttons .btn:hover,
.weight-buttons .btn.active {
    background-color: var(--secondary-color);
    color: #fff;
}

/* Quantity Selector */
.quantity {
    display: flex;
    align-items: center;
    gap: 15px;
}

.quantity .input-group {
    max-width: 120px;
}

.quantity .btn {
    padding: 5px 10px;
    border-radius: var(--border-radius);
    background-color: var(--light-pink-color);
    color: var(--secondary-color);
    border: 1px solid var(--secondary-color);
    transition: all 0.3s ease;
}

.quantity .btn:hover {
    background-color: var(--secondary-color);
    color: #fff;
}

/* Buy and Cart Buttons */
#buy-button,
#cart-button {
    padding: 10px 20px;
    border-radius: var(--border-radius);
    font-size: var(--font-size-md);
    color: #fff;
    background-color: var(--secondary-color);
    border: none;
    transition: all 0.3s ease;
}

#buy-button:hover,
#cart-button:hover {
    background-color: transparent;
    color: var(--secondary-color);
    border: 1px solid var(--secondary-color);
}

/* Description Section */
.descrip-info-use {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    margin-top: 30px;
}

.descrip-info-use-btn .btn {
    padding: 10px 15px;
    font-size: var(--font-size-md);
    border-radius: var(--border-radius);
    background-color: var(--light-pink-color);
    color: var(--secondary-color);
    border: 1px solid var(--secondary-color);
    transition: all 0.3s ease;
}

.descrip-info-use-btn .btn:hover,
.descrip-info-use-btn .btn.active {
    background-color: var(--secondary-color);
    color: #fff;
}

/* Responsive Styles */
@media (max-width: 768px) {
    .product-detailt-section {
        padding-top: 80px;
    }

    .product-title {
        font-size: 1.25rem;
    }

    .product-price {
        font-size: 1rem;
    }

    .weight-buttons .btn {
        padding: 5px 10px;
        font-size: var(--font-size-sm);
    }

    .quantity .btn {
        padding: 5px 8px;
    }

    #buy-button,
    #cart-button {
        font-size: var(--font-size-sm);
        padding: 8px 12px;
    }
}

    </style>
</head>
<body>
    <!-- Header -->
    <header class="bg-light shadow-sm fixed-top">
        <nav class="navbar navbar-expand-lg navbar-light">
            <div class="container">
                <a href="TrangChuPettie.html" class="navbar-brand fw-bold text-primary">Pettie</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item"><a class="nav-link" href="#">Trang Chủ</a></li>
                        <li class="nav-item"><a class="nav-link" href="#shop">Cửa Hàng</a></li>
                        <li class="nav-item"><a class="nav-link" href="#service">Dịch Vụ</a></li>
                        <li class="nav-item"><a class="nav-link" href="#veter">Phòng Khám</a></li>
                        <li class="nav-item"><a class="nav-link" href="#">Đăng Nhập</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="pt-5 mt-5">
        <section class="container my-5">
            <div class="row">
                <!-- Product Gallery -->
                <div class="col-md-6">
                    <div class="border rounded p-3 mb-4">
                        <img id="mainImage" class="img-fluid rounded" alt="Main Product Image">
                    </div>
                    <div class="d-flex flex-wrap gap-2 justify-content-center">
                        <!-- Small Images Dynamically Rendered -->
                        <img src="" class="small-img border rounded" alt="Small Image">
                        <img src="" class="small-img border rounded" alt="Small Image">
                    </div>
                </div>

                <!-- Product Details -->
                <div class="col-md-6">
                    <h1 id="product-name" class="fw-bold text-dark">Tên sản phẩm</h1>
                    <p id="product-price" class="fs-4 text-danger">Giá: 0 VND</p>
                    <p id="product-description" class="text-muted">Mô tả sản phẩm</p>

                    <!-- Product Weight -->
                    <div class="mb-3">
                        <h5>Trọng lượng:</h5>
                        <div id="weight-buttons" class="btn-group" role="group">
                            <button type="button" class="btn btn-outline-secondary">100g</button>
                            <button type="button" class="btn btn-outline-secondary">200g</button>
                        </div>
                    </div>

                    <!-- Product Quantity -->
                    <div class="d-flex align-items-center mb-3">
                        <h5 class="me-3">Số lượng:</h5>
                        <div class="input-group" style="max-width: 150px;">
                            <button class="btn btn-outline-secondary" id="decrement">-</button>
                            <input type="text" class="form-control text-center" value="1" id="quantity" readonly>
                            <button class="btn btn-outline-secondary" id="increment">+</button>
                        </div>
                    </div>

                    <!-- Buttons -->
                    <div class="mt-4">
                        <button id="buy-button" class="btn btn-primary me-3">Mua ngay</button>
                        <button id="cart-button" class="btn btn-outline-primary">Thêm vào giỏ hàng</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-light py-4">
        <div class="container text-center">
            <p class="mb-0">© Pettie 2024. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const contentDiv = document.querySelector('.descrip-info-use-content');

// Gọi API để hiển thị nội dung động
async function fetchAndDisplayContent(action) {
    try {
        const response = await fetch(`/api/products/${productId}`);
        const data = await response.json();
        let content = '';
        switch (action) {
            case 'description':
                content = data.description || 'Không có mô tả sản phẩm.';
                break;
            case 'ingredients':
                content = data.ingredients || 'Không có thành phần.';
                break;
            default:
                content = 'Nội dung không xác định.';
        }
        contentDiv.textContent = content; // Hiển thị nội dung
    } catch (error) {
        console.error('Lỗi khi tải nội dung:', error);
        contentDiv.textContent = 'Đã xảy ra lỗi khi tải nội dung.';
    }
}

// Gắn sự kiện click cho các nút
document.querySelectorAll('.description-btn').forEach(button => {
    button.addEventListener('click', () => {
        const action = button.getAttribute('data-action');
        fetchAndDisplayContent(action);
    });
});

const urlParam = new URLSearchParams(window.location.search);
const productIds = urlParam.get("id");
                

const mainImage = document.getElementById('mainImage');
const smallImgRow = document.querySelector('.small-img-row');

// Gọi API để lấy hình ảnh
function fetchProductImages(productIds) {
    fetch(`/api/images/img/${productIds}`)
        .then(response => response.json())
        .then(data => {
            if (data.images && data.images.length) {
                mainImage.src = data.images[0]; // Hiển thị ảnh đầu tiên
                data.images.forEach(imgUrl => {
                    const img = document.createElement('img');
                    img.src = imgUrl;
                    img.className = 'small-img border rounded';
                    img.alt = 'Ảnh nhỏ sản phẩm';
                    img.addEventListener('click', () => {
                        mainImage.src = imgUrl; // Đổi ảnh chính
                    });
                    smallImgRow.appendChild(img);
                });
            }
        })
        .catch(error => console.error('Lỗi khi tải hình ảnh:', error));
}

// Gọi API khi trang tải
if (productIds) {
    fetchProductImages(productIds);
}
const weightButtonsContainer = document.getElementById('weight-buttons');

// Gọi API để lấy trọng lượng
function fetchProductWeights(productIds) {
    fetch(`http://localhost:8080/api/productweights/${productIds}`)
        .then(response => response.json())
        .then(weights => {
            weightButtonsContainer.innerHTML = ''; // Xóa các nút cũ
            weights.forEach(weight => {
                const button = document.createElement('button');
                button.className = 'btn btn-outline-secondary';
                button.textContent = `${weight.weight}g`;
                button.setAttribute('data-price', weight.price);
                button.addEventListener('click', () => updatePrice(weight.price));
                weightButtonsContainer.appendChild(button);
            });
        })
        .catch(error => console.error('Lỗi khi lấy trọng lượng:', error));
}

// Cập nhật giá tiền khi chọn trọng lượng
function updatePrice(price) {
    document.getElementById('product-price').textContent = `${price.toLocaleString('vi-VN')} VND`;
}

// Gọi API khi trang tải
const productId = new URLSearchParams(window.location.search).get('id');
if (productId) {
    fetchProductWeights(productId);
}
// Tăng/giảm số lượng sản phẩm
document.getElementById('decrement').addEventListener('click', () => {
    let quantity = parseInt(document.getElementById('quantity').value);
    if (quantity > 1) {
        quantity--;
        document.getElementById('quantity').value = quantity;
    }
});

document.getElementById('increment').addEventListener('click', () => {
    let quantity = parseInt(document.getElementById('quantity').value);
    quantity++;
    document.getElementById('quantity').value = quantity;
});

    </script>
</body>
</html>
