<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Page</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css">
    <script src="./js/main.js"></script>

    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
    <style>
          .hero-image {
            width: 100%; /* Đảm bảo ảnh chiếm toàn bộ chiều rộng */
            height: 600px; /* Chiều cao ảnh */
            overflow: hidden; /* Đảm bảo ảnh không bị tràn */
        }

        .hero-image img {
            width: 100%; /* Đảm bảo ảnh bao phủ toàn bộ chiều rộng */
            height: 100%; /* Đảm bảo ảnh bao phủ toàn bộ chiều cao */
            object-fit: cover; /* Đảm bảo ảnh không bị biến dạng */
        }

        .mySwiper {
            width: 80%; /* Adjust the width for responsiveness */
            height: 350px; /* Set an appropriate height */
            margin-top: 10%; /* Center and add spacing */
        }
        .mySwiper img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Ensure the images fill the container */
        }
        /* Responsive adjustments for tablets and phones */
        @media (max-width: 1024px) {
            .mySwiper {
                height: 300px; /* Reduce height for tablets */
                margin-top: 15%; /* Add slight margin for spacing */
            }
        }

        @media (max-width: 768px) {
            .mySwiper {
                height: 250px; /* Reduce height further for phones */
                margin-top: 20%; /* Add more margin for phones */
            }

            .navbar-brand {
                font-size: 1.2rem; /* Adjust navbar brand size */
            }

            .nav-link {
                font-size: 0.9rem; /* Adjust navbar link size */
            }

            .breadcrumb {
                font-size: 0.8rem; /* Smaller breadcrumb for phones */
            }
        }
    </style>
</head>
<body>
   <div id="header"></div>
    <!-- Hero Section with a single image -->
    <div class="hero-image">
        <img src="./img/hero9.png" alt="Hero Image" class="w-100">
    </div>


    <div class="container">
        <!-- Breadcrumb Navigation -->
        <div class="d-flex justify-content-center mb-4">
            <ul class="breadcrumb">
                <li class="breadcrumb-item"><a href="./trangchu.html">Trang Chủ</a></li>
                <li class="breadcrumb-item"><a href="./product.html">Cửa Hàng</a></li>
                <li class="breadcrumb-item"><a href="#" id="categoryBreadcrumb">tất cả sản phẩm</a></li>
            </ul>
        </div>

        <div class="row">
            <!-- Sidebar for Filters -->
            <div class="col-md-3">
                <div class="border p-2">
                    <h5>Filters</h5>
                    <div class="mb-2">
                        <label for="categoryFilter" class="form-label">Danh Mục</label>
                        <select id="categoryFilter" class="form-select form-select-sm">
                            <option value="all">Tất cả sản phẩm</option>
                            <option value="thức ăn cho chó">thức ăn cho chó</option>
                            <option value="thức ăn cho mèo">thức ăn cho mèo</option>
                            <option value="Dụng cụ vệ sinh">Dụng cụ vệ sinh</option>
                            <option value="Đồ chơi cho chó mèo">Đồ chơi cho chó mèo</option>
                        </select>
                    </div>
                    <div class="mb-2">
                        <label for="priceFilter" class="form-label">Giá</label>
                        <select id="priceFilter" class="form-select form-select-sm">
                            <option value="all">Tất cả giá</option>
                            <option value="0-100">0 VND - 100,000 VND</option>
                            <option value="100-500">100,000 VND - 500,000 VND</option>
                            <option value="500">Lớn hơn 500,000 VND</option>
                        </select>
                    </div>
                    <button class="btn btn-sm btn-lg w-100" id="applyFilters">Áp dụng</button>
                </div>
            </div>
            
            <!-- Product Display Section -->
            <div class="col-md-9">
                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4" id="productsearchList">
                    <!-- Products will be dynamically loaded here -->
                </div>
            </div>
        </div>
    </div>


            
<footer class="bg-white text-black py-5">
    <div class="container">
        <!-- Logo and Brand -->
        <div class="text-center mb-4">
         
            <h5 class="mt-2">Pettie</h5>
        </div>

        <!-- Footer Links -->
        <div class="row text-center">
            <!-- Services Column -->
            <div class="col-md-4 mb-4">
                <h6 class="fw-bold">Dịch Vụ</h6>
                <ul class="list-unstyled" >
                    <li><a href="#" class="text-black text-decoration-none">Pet Grooming</a></li>
                    <li><a href="#" class="text-black text-decoration-none">Veterinary Care</a></li>
                    <li><a href="#" class="text-black text-decoration-none">Pet Supplies</a></li>
                </ul>
            </div>

            <!-- About Column -->
            <div class="col-md-4 mb-4">
                <h6 class="fw-bold">Giới Thiệu</h6>
                <ul class="list-unstyled">
                    <li><a href="#" class="text-black text-decoration-none">Pettie</a></li>
                    <li><a href="#" class="text-black text-decoration-none">dịch vụ</a></li>
                    <li><a href="#" class="text-black text-decoration-none">cửa hàng</a></li>
                </ul>
            </div>

            <!-- Careers Column -->
            <div class="col-md-4 mb-4">
                <h6 class="fw-bold">Cam kết</h6>
                <ul class="list-unstyled">
                    <li><a href="#" class="text-black text-decoration-none">miễn phí vận chuyển</a></li>
                    <li><a href="#" class="text-black text-decoration-none">chuyên nghiệp</a></li>
                    <li><a href="#" class="text-black text-decoration-none">sản phẩm an toàn</a></li>
                </ul>
            </div>
        </div>

        <!-- Footer Bottom -->
        <div class="text-center border-top pt-3">
            <p class="mb-0">&copy; 2024 Pettie</p>
            <div class="mt-2">
                <a href="#" class="text-black me-2"><i class="bi bi-facebook"></i></a>
                <a href="#" class="text-black me-2"><i class="bi bi-twitter"></i></a>
                <a href="#" class="text-black"><i class="bi bi-instagram"></i></a>
            </div>
        </div>
    </div>
</footer>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
    <script>
        // Initialize Swiper
        const swiper = new Swiper('.mySwiper', {
            loop: true,
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            autoplay: {
                delay: 3000,
                disableOnInteraction: false,
            },
        });

      
    </script>
    <script src="./js/script.js"></script>
    <script src="./js/script-product-detail.js"></script>
    <script src="./js/header.js"></script>
    <script src="./js/search.js"></script>
    <!-- <script src="./js/script.js"></script> -->
    <script>
// Lắng nghe sự kiện khi người dùng chọn bộ lọc và bấm nút "Áp dụng"
document.getElementById("applyFilters").addEventListener("click", function() {
    // Lấy giá trị bộ lọc category và price
    const categoryFilter = document.getElementById("categoryFilter").value;
    const priceFilter = document.getElementById("priceFilter").value;

    // Cập nhật breadcrumb với category đã chọn
    updateBreadcrumb(categoryFilter);

    // Gọi API hoặc xử lý logic lọc sản phẩm
    fetchFilteredProducts(categoryFilter, priceFilter);
});

document.getElementById("categoryBreadcrumb").addEventListener("click", function(event) {
    event.preventDefault(); // Ngăn không cho chuyển trang khi click vào thẻ <a>
    const categoryFilter = document.getElementById("categoryFilter").value;
    // Cập nhật breadcrumb để hiển thị category đang chọn
    updateBreadcrumb(categoryFilter);

    // Lọc sản phẩm theo category đã chọn
    fetchFilteredProducts(categoryFilter);
});
// Hàm gọi API để lọc sản phẩm theo category
function fetchFilteredProducts(category) {
    // Giả sử bạn có API lọc sản phẩm theo category
    fetch(`/api/products/filter?category=${category}&price=all`)
        .then(response => response.json())
        .then(data => {
            displayProducts(data); // Hiển thị sản phẩm đã lọc
        })
        .catch(error => {
            console.error("Error fetching filtered products:", error);
        });
}
// Hàm cập nhật breadcrumb
function updateBreadcrumb(category) {
    const categoryBreadcrumb = document.querySelector(".breadcrumb-item:last-child a");
    
    // Cập nhật nội dung của breadcrumb
    if (category === "thức ăn cho chó") {
        categoryBreadcrumb.textContent = "thức ăn cho chó";
    } else if (category === "thức ăn cho mèo") {
        categoryBreadcrumb.textContent = "thức ăn cho mèo";
    } else if (category === "Dụng cụ vệ sinh") {
        categoryBreadcrumb.textContent = "Dụng cụ vệ sinh";
    }   else if (category === "Đồ chơi cho chó mèo") {
        categoryBreadcrumb.textContent = "Đồ chơi cho chó mèo";
    } 
    else {
        categoryBreadcrumb.textContent = "Tất cả sản phẩm";
    }
}
// Hàm gọi API để lọc sản phẩm theo category
function fetchFilteredProducts(category) {
    // Giả sử bạn có một API để lọc sản phẩm theo category
    fetch(`/api/products/filter?category=${category}&price=all`)
        .then(response => response.json())
        .then(data => {
            displayProducts(data); // Hiển thị sản phẩm sau khi lọc
        })
        .catch(error => {
            console.error("Error fetching filtered products:", error);
        });
}

// Hàm gọi API để lấy sản phẩm đã lọc
function fetchFilteredProducts(category, price) {
    // Giả sử API trả về một mảng các sản phẩm đã lọc
    fetch(`/api/products/filter?category=${category}&price=${price}`)
        .then(response => response.json())
        
        .then(data => {
            console.log("Category:", category);
            console.log("Price:", price);

            displayProducts(data); // Hiển thị sản phẩm đã lọc
        })
        .catch(error => {
            console.error("Error fetching filtered products:", error);
        });
}

// Hàm hiển thị danh sách sản phẩm
function displayProducts(products) {
    const productList = document.getElementById("productList");
    productList.innerHTML = ""; // Xóa tất cả sản phẩm hiện tại

    products.forEach(product => {
        const productDiv = createProductItem(product); // Sử dụng hàm createProductItem đã có
        productList.appendChild(productDiv); // Thêm sản phẩm vào danh sách
    });
}

function createProductItem(product) {
    const productDiv = document.createElement("div");
    productDiv.classList.add("col");

    // Kiểm tra trạng thái còn hàng
    const stockStatus = product.quantity === 0 
        ? '<span style="color:blue; font-weight:bold;">HẾT HÀNG</span>' 
        : "";
    
    const imageUrl = product.url.replace(/.*\/html\//, "/img/");

    productDiv.className = "col-2 d-flex"; 
    productDiv.style.flex = "0 0 20%";
    productDiv.style.maxWidth = "20%";
    productDiv.innerHTML = `
        <div class="card product-card w-100 h-100 d-flex flex-column">
            <a href="product-detail.html?id=${product.id}" class="product-link">
                <img src="${imageUrl || 'default-image.png'}" class="card-img-top product-image" alt="${product.name}" style="height: 150px; object-fit: contain;">
            </a>
            <div class="card-body d-flex flex-column justify-content-between">
                <h6 class="card-title product-title">${product.name}</h6>
                <p class="card-text product-price">${formatPrice(product.price)} VND</p>
                <div class="product-actions mt-auto">
                    ${stockStatus}
                    ${product.quantity === 0 ? '' : '<button class="buy-now" data-product-id="' + product.id + '">Thêm vào giỏ hàng</button>'}
                </div>
            </div>
        </div>
    `;
    
    return productDiv;
}

    </script>
    <script src="./js/chat.js"></script>

    <button id="chatWithAI"></button>

    <!-- Modal chứa nội dung ChatGPT -->
    <div id="chatModal" style="display: none;">
    <script>
        document.addEventListener("DOMContentLoaded", function () {
           const chatBtn = document.getElementById("chatWithAI");
           const chatModal = document.getElementById("chatModal");
       
           chatBtn.addEventListener("click", function () {
               chatModal.style.display = "flex"; // Hiện modal
               fetch("chatgpt.html") // Tải nội dung từ chatgpt.html
                   .then(response => response.text())
                   .then(data => {
                       chatModal.innerHTML = data;
                       addChatGPTListeners(); // Kích hoạt lại sự kiện khi tải xong nội dung chatgpt.html
                   })
                   .catch(error => console.error("Lỗi khi tải chatgpt.html:", error));
           });
       
           function addChatGPTListeners() {
               const closeChat = document.getElementById("closeChat");
               if (closeChat) {
                   closeChat.addEventListener("click", function () {
                       chatModal.style.display = "none";
                   });
               }
           }
       });
       
       
        </script>
</body>
</html>
